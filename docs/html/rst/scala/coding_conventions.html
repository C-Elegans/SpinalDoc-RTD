

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Introduction &mdash; SpinalHDL 1.11 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> SpinalHDL
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">About SpinalHDL:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../support.html">Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">FAQ</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">SpinalHDL</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
      <li>Introduction</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/rst/scala/coding_conventions.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="introduction">
<h1>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h1>
<p>The coding conventions used in SpinalHDL is the same than the one documented in the <a class="reference external" href="http://docs.scala-lang.org/style/">scala doc</a>.</p>
<p>Then some additional practice and practical cases are explained in next chapters.</p>
</div>
<div class="section" id="class-vs-case-class">
<h1>class vs case class<a class="headerlink" href="#class-vs-case-class" title="Permalink to this headline">¶</a></h1>
<p>When you need to define a Bundle or a Component, have a preference to declare them as case class.</p>
<p>Reasons are :</p>
<ul class="simple">
<li>It avoid the use of the new keywords. Never having to use it is better than sometime in some condition.</li>
<li>The case class provide an clone function. This is useful when SpinalHDL need to clone one Bundle. For example when you define a new Reg or a new Stream of something.</li>
<li>Construction parameters are directly visible from outside.</li>
</ul>
<div class="section" id="case-class">
<h2>[case] class<a class="headerlink" href="#case-class" title="Permalink to this headline">¶</a></h2>
<p>All class’s names should start with a upper case letter</p>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Fifo</span> <span class="k">extends</span> <span class="nc">Component</span> <span class="o">{</span>

<span class="o">}</span>

<span class="k">class</span> <span class="nc">Counter</span> <span class="k">extends</span> <span class="nc">Area</span> <span class="o">{</span>

<span class="o">}</span>

<span class="k">case</span> <span class="k">class</span> <span class="nc">Color</span> <span class="k">extends</span> <span class="nc">Bundle</span> <span class="o">{</span>

<span class="o">}</span>
</pre></div>
</div>
</div>
<div class="section" id="companion-object">
<h2>companion object<a class="headerlink" href="#companion-object" title="Permalink to this headline">¶</a></h2>
<p>Companion object should start with a upper case letter.</p>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="k">object</span> <span class="nc">Fifo</span> <span class="o">{</span>
  <span class="k">def</span> <span class="n">apply</span><span class="o">(</span><span class="n">that</span><span class="k">:</span> <span class="kt">Stream</span><span class="o">[</span><span class="kt">Bits</span><span class="o">])</span><span class="k">:</span> <span class="kt">Stream</span><span class="o">[</span><span class="kt">Bits</span><span class="o">]</span> <span class="k">=</span> <span class="o">{...}</span>
<span class="o">}</span>

<span class="k">object</span> <span class="nc">MajorityVote</span> <span class="o">{</span>
  <span class="k">def</span> <span class="n">apply</span><span class="o">(</span><span class="n">that</span><span class="k">:</span> <span class="kt">Bits</span><span class="o">)</span><span class="k">:</span> <span class="kt">UInt</span> <span class="o">=</span> <span class="o">{...}</span>
<span class="o">}</span>
</pre></div>
</div>
<p>A exception to this rule is be when the compagnion object is used as a function (only <code class="docutils literal notranslate"><span class="pre">apply</span></code> inside), and these <code class="docutils literal notranslate"><span class="pre">apply</span></code> functions doesn’t generate hardware :</p>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="k">object</span> <span class="nc">log2</span><span class="o">{</span>
  <span class="k">def</span> <span class="n">apply</span><span class="o">(</span><span class="n">value</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="o">{...}</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
<div class="section" id="function">
<h2>function<a class="headerlink" href="#function" title="Permalink to this headline">¶</a></h2>
<p>Function should always start with a lower case letter :</p>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="n">sinTable</span> <span class="k">=</span> <span class="o">(</span><span class="mi">0</span> <span class="n">until</span> <span class="n">sampleCount</span><span class="o">).</span><span class="n">map</span><span class="o">(</span><span class="n">sampleIndex</span> <span class="k">=&gt;</span> <span class="o">{</span>
  <span class="k">val</span> <span class="n">sinValue</span> <span class="k">=</span> <span class="nc">Math</span><span class="o">.</span><span class="n">sin</span><span class="o">(</span><span class="mi">2</span> <span class="o">*</span> <span class="nc">Math</span><span class="o">.</span><span class="nc">PI</span> <span class="o">*</span> <span class="n">sampleIndex</span> <span class="o">/</span> <span class="n">sampleCount</span><span class="o">)</span>
  <span class="n">S</span><span class="o">((</span><span class="n">sinValue</span> <span class="o">*</span> <span class="o">((</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">resolutionWidth</span><span class="o">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="o">)).</span><span class="n">toInt</span><span class="o">,</span> <span class="n">resolutionWidth</span> <span class="n">bits</span><span class="o">)</span>
<span class="o">})</span>

<span class="k">val</span> <span class="n">rom</span> <span class="k">=</span>  <span class="nc">Mem</span><span class="o">(</span><span class="nc">SInt</span><span class="o">(</span><span class="n">resolutionWidth</span> <span class="n">bit</span><span class="o">),</span><span class="n">initialContent</span> <span class="k">=</span> <span class="n">sinTable</span><span class="o">)</span>
</pre></div>
</div>
</div>
<div class="section" id="instances">
<h2>instances<a class="headerlink" href="#instances" title="Permalink to this headline">¶</a></h2>
<p>Instances of classes should always start with lower case letter :</p>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="k">val</span> <span class="n">fifo</span>   <span class="k">=</span> <span class="k">new</span> <span class="nc">Fifo</span><span class="o">()</span>
<span class="k">val</span> <span class="n">buffer</span> <span class="k">=</span> <span class="nc">Reg</span><span class="o">(</span><span class="nc">Bits</span><span class="o">(</span><span class="mi">8</span> <span class="n">bits</span><span class="o">))</span>
</pre></div>
</div>
</div>
<div class="section" id="if-when">
<h2>if / when<a class="headerlink" href="#if-when" title="Permalink to this headline">¶</a></h2>
<p>Scala <code class="docutils literal notranslate"><span class="pre">if</span></code> and SpinalHDL <code class="docutils literal notranslate"><span class="pre">when</span></code> should normally be written by the following way :</p>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="k">if</span><span class="o">(</span><span class="n">cond</span><span class="o">){</span>
  <span class="o">...</span>
<span class="o">}</span> <span class="k">else</span> <span class="k">if</span><span class="o">(</span><span class="n">cond</span><span class="o">){</span>

<span class="o">}</span> <span class="k">else</span> <span class="o">{</span>

<span class="o">}</span>

<span class="n">when</span><span class="o">(</span><span class="n">cond</span><span class="o">){</span>

<span class="o">}.</span><span class="n">elseWhen</span><span class="o">(</span><span class="n">cond</span><span class="o">){</span>

<span class="o">}.</span><span class="n">otherwise</span><span class="o">{</span>

<span class="o">}</span>
</pre></div>
</div>
<p>Exceptions could be :</p>
<ul class="simple">
<li>It’s fine to omit the dot before otherwise.</li>
<li>It’s fine to compress a whole <code class="docutils literal notranslate"><span class="pre">if</span></code>/<code class="docutils literal notranslate"><span class="pre">when</span></code> statements on a single line if it make the code more readable</li>
</ul>
</div>
<div class="section" id="switch">
<h2>switch<a class="headerlink" href="#switch" title="Permalink to this headline">¶</a></h2>
<p>SpinalHDL switch should normally be written by the following way :</p>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="n">switch</span><span class="o">(</span><span class="n">value</span><span class="o">){</span>
  <span class="n">is</span><span class="o">(</span><span class="n">key</span><span class="o">){</span>

  <span class="o">}</span>
  <span class="n">is</span><span class="o">(</span><span class="n">key</span><span class="o">){</span>

  <span class="o">}</span>
  <span class="n">default</span><span class="o">{</span>

  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<p>It’s fine to compress a <code class="docutils literal notranslate"><span class="pre">is</span></code>/<code class="docutils literal notranslate"><span class="pre">default</span></code> statements on a single line if it make the code more readable</p>
</div>
<div class="section" id="parameters">
<h2>Parameters<a class="headerlink" href="#parameters" title="Permalink to this headline">¶</a></h2>
<p>Grouping parameters of a component/bundle inside a case class is in general welcome :</p>
<ul class="simple">
<li>Easier to carry/manipulate to configure the design</li>
<li>Better maintainability</li>
</ul>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="k">case</span> <span class="k">class</span> <span class="nc">RgbConfig</span><span class="o">(</span><span class="n">rWidth</span><span class="k">:</span> <span class="kt">Int</span><span class="o">,</span> <span class="n">gWidth</span><span class="k">:</span> <span class="kt">Int</span><span class="o">,</span> <span class="n">bWidth</span><span class="k">:</span> <span class="kt">Int</span><span class="o">){</span>
  <span class="k">def</span> <span class="n">getWidth</span> <span class="k">=</span> <span class="n">rWidth</span> <span class="o">+</span> <span class="n">gWidth</span> <span class="o">+</span> <span class="n">bWidth</span>
<span class="o">}</span>

<span class="k">case</span> <span class="k">class</span> <span class="nc">Rgb</span><span class="o">(</span><span class="n">c</span><span class="k">:</span> <span class="kt">RgbConfig</span><span class="o">)</span> <span class="k">extends</span> <span class="nc">Bundle</span> <span class="o">{</span>
  <span class="k">val</span> <span class="n">r</span> <span class="k">=</span> <span class="nc">UInt</span><span class="o">(</span><span class="n">c</span><span class="o">.</span><span class="n">rWidth</span> <span class="n">bit</span><span class="o">)</span>
  <span class="k">val</span> <span class="n">g</span> <span class="k">=</span> <span class="nc">UInt</span><span class="o">(</span><span class="n">c</span><span class="o">.</span><span class="n">gWidth</span> <span class="n">bit</span><span class="o">)</span>
  <span class="k">val</span> <span class="n">b</span> <span class="k">=</span> <span class="nc">UInt</span><span class="o">(</span><span class="n">c</span><span class="o">.</span><span class="n">bWidth</span> <span class="n">bit</span><span class="o">)</span>
<span class="o">}</span>
</pre></div>
</div>
<p>But this should not be applied in all cases, for example for a Fifo, it doesn’t make sense to group the dataType parameter with the depth of the fifo because in general the dataType is something related to the design while the depth is something related to the configuration of the design.</p>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Fifo</span><span class="o">[</span><span class="kt">T</span> <span class="k">&lt;:</span> <span class="kt">Data</span><span class="o">](</span><span class="n">dataType</span><span class="k">:</span> <span class="kt">T</span><span class="o">,</span> <span class="n">depth</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span> <span class="k">extends</span> <span class="nc">Component</span> <span class="o">{</span>

<span class="o">}</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, penis

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    

  

  <script type="text/javascript" src="../../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>